cmake_minimum_required (VERSION 3.21)

project ("assfonts")

set(CMAKE_CXX_STANDARD 11)
set(CMAKE_C_STANDARD 99)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)

set(VCPKG_INCLUDE_DIR ${VCPKG_INSTALLED_DIR}/${VCPKG_TARGET_TRIPLET}/include)

find_package(harfbuzz CONFIG REQUIRED)
find_package(freetype CONFIG REQUIRED)
find_package(Boost REQUIRED filesystem locale serialization system thread program_options)
find_package(spdlog CONFIG REQUIRED)
find_package(fmt CONFIG REQUIRED)
find_package(wxWidgets CONFIG REQUIRED)

add_library(harfbuzz-subset INTERFACE IMPORTED PRIVATE)
find_library(HARFBUZZ_SUBSET_LIBRARY_DEBUG NAMES harfbuzz-subset PATHS "${VCPKG_INSTALLED_DIR}/${VCPKG_TARGET_TRIPLET}/debug" PATH_SUFFIXES lib NO_DEFAULT_PATH REQUIRED)
if(HARFBUZZ_SUBSET_LIBRARY_DEBUG)
    target_link_libraries(harfbuzz-subset INTERFACE $<$<CONFIG:DEBUG>:${HARFBUZZ_SUBSET_LIBRARY_DEBUG}>)
endif()
find_library(HARFBUZZ_SUBSET_LIBRARY_RELEASE NAMES harfbuzz-subset PATHS "${VCPKG_INSTALLED_DIR}/${VCPKG_TARGET_TRIPLET}" PATH_SUFFIXES lib NO_DEFAULT_PATH REQUIRED)
target_link_libraries(harfbuzz-subset INTERFACE $<$<NOT:$<CONFIG:DEBUG>>:${HARFBUZZ_SUBSET_LIBRARY_RELEASE}>)

if (CMAKE_CXX_COMPILER_ID STREQUAL "MSVC")
    if(CMAKE_BUILD_TYPE MATCHES "Debug")
        SET(COMPILE_OPTIONS /Od /W4 /WX /MDd /D_WIN32_WINNT=0x0601)
    elseif(CMAKE_BUILD_TYPE MATCHES "Release")
        SET(COMPILE_OPTIONS /O2 /W4 /WX /MT /D_WIN32_WINNT=0x0601)
    endif()
elseif (CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
    if(CMAKE_BUILD_TYPE MATCHES "Debug")
        SET(COMPILE_OPTIONS -O0 -Wall -Werror)
    elseif(CMAKE_BUILD_TYPE MATCHES "Release")
        SET(COMPILE_OPTIONS -O2 -Wall -Werror)
    endif()
endif()

add_subdirectory(${PROJECT_SOURCE_DIR}/lib)
add_subdirectory(${PROJECT_SOURCE_DIR}/src)
add_subdirectory(${PROJECT_SOURCE_DIR}/gui)